<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>&quot;サンプルデモ&quot;の目次  | Atmoph Window SDK for Unity v1.0 </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="&quot;サンプルデモ&quot;の目次  | Atmoph Window SDK for Unity v1.0 ">
      
      
      <link rel="icon" href="images/favicon_atmoph.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      <meta name="docfx:docurl" content="https://bitbucket.org/atmophinc/limosaunitysdk/src/main/Docfx/sample_demo_1.md#lines-1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="images/icon_atmophlogo_2.png" alt="Atmoph Window SDK for Unity v1.0">
            Atmoph Window SDK for Unity v1.0
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="サンプルデモの目次-">&quot;サンプルデモ&quot;の目次 <!-- omit in toc --></h1>

<ul>
<li><a href="#1-%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%87%E3%83%A2-roll-a-ball-game-for-atmoph-window">1. サンプルデモ Roll-a-Ball Game for Atmoph Window</a>
<ul>
<li><a href="#11-%E5%8B%95%E3%81%8B%E3%81%97%E6%96%B9">1.1. 動かし方</a>
<ul>
<li><a href="#111-unityhub%E3%81%A7universal-3d-%E3%81%AE%E7%A9%BA%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">1.1.1. UnityHubでUniversal 3D の空プロジェクトを作成する。</a></li>
<li><a href="#112-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%83%87%E3%83%A2%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8rollaballforatmophwindow_v1_0unitypackage%E3%82%92%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88%E3%81%99%E3%82%8B">1.1.2. プロジェクトにサンプルデモパッケージ&quot;rollaballforatmophwindow_v1_0.unitypackage&quot;をインポートする。</a></li>
<li><a href="#113-%E3%83%93%E3%83%AB%E3%83%89%E8%A8%AD%E5%AE%9A%E3%82%92%E5%AE%9F%E6%96%BD%E3%81%99%E3%82%8B">1.1.3. ビルド設定を実施する。</a></li>
<li><a href="#114-project%E3%81%AEassets---scenes-%E3%81%AE-minigame%E3%82%92%E9%96%8B%E3%81%8F">1.1.4. Projectの&quot;Assets&quot; -&gt; &quot;Scenes&quot; の &quot;MiniGame&quot;を開く</a></li>
<li><a href="#115-build-profiles%E3%81%AE-scene-list-%E3%81%8C-minigame-%E3%81%AE%E3%81%BF%E3%81%AB%E3%81%AA%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E8%A8%AD%E5%AE%9A">1.1.5. &quot;Build Profiles&quot;の &quot;Scene List&quot; が &quot;MiniGame&quot; のみになるように設定</a></li>
<li><a href="#116-build-and-run-%E3%82%92%E5%AE%9F%E8%A1%8C">1.1.6. &quot;Build And Run&quot; を実行</a></li>
</ul>
</li>
<li><a href="#12-%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8Bsdk%E3%81%AE%E6%A9%9F%E8%83%BD">1.2. 使用しているSDKの機能</a>
<ul>
<li><a href="#121-scope%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E6%93%8D%E4%BD%9C%E3%81%AE%E6%A4%9C%E7%9F%A5--%E3%83%97%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E3%82%92scope%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">1.2.1. Scopeのボタン操作の検知 : プレイヤーをScopeのボタンでコントロールできるようにする</a></li>
<li><a href="#122-scope%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%8D%E7%BD%AE%E5%90%91%E3%81%8D%E8%B7%9D%E9%9B%A2%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97--%E5%9C%B0%E9%9D%A2%E3%81%AE%E8%A7%92%E5%BA%A6%E3%82%92scope%E3%81%AE%E5%90%91%E3%81%8D%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%88%E3%83%AD%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B">1.2.2. Scopeのポインティング位置、向き、距離センター値の取得 : 地面の角度をScopeの向きでコントロールできるようにする</a></li>
<li><a href="#123-scope%E3%81%AE%E3%82%BA%E3%83%BC%E3%83%A0%E3%83%AA%E3%83%B3%E3%82%B0%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%8F%96%E5%BE%97%E3%82%BA%E3%83%BC%E3%83%A0%E3%83%AA%E3%83%B3%E3%82%B0%E3%82%AF%E3%82%A9%E3%83%BC%E3%82%BF%E3%83%8B%E3%82%AA%E3%83%B3%E5%BD%A2%E5%BC%8F%E3%81%AEscope%E3%81%AE%E5%90%91%E3%81%8D%E3%83%9C%E3%82%BF%E3%83%B3%E7%8A%B6%E6%85%8B%E3%81%AE%E7%94%BB%E9%9D%A2%E5%87%BA%E5%8A%9B">1.2.3. Scopeのズームリングデータの取得：ズームリング、クォータニオン形式のScopeの向き、ボタン状態の画面出力</a></li>
<li><a href="#124-scope%E3%81%AE%E5%8B%95%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%8E%A5%E7%B6%9A%E7%8A%B6%E6%85%8B%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E6%AE%8B%E9%87%8F%E6%8E%A5%E7%B6%9A%E7%8A%B6%E6%85%8B%E3%81%AE%E7%94%BB%E9%9D%A2%E8%A1%A8%E7%A4%BA%E3%82%84%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E6%AE%8B%E9%87%8F%E3%81%AE%E3%83%AD%E3%82%B0%E5%87%BA%E5%8A%9B">1.2.4. Scopeの動的情報の取得（接続状態、アドレス、バッテリー残量）：接続状態の画面表示や、バッテリー残量のログ出力</a>
<ul>
<li><a href="#1241-windowprotocolscopeconnectionstate%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E7%94%A8">1.2.4.1. WindowProtocol.ScopeConnectionStateプロパティを使用</a></li>
<li><a href="#1242-windowprotocolgetscopes%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8">1.2.4.2. WindowProtocol.GetScopesメソッドを使用</a></li>
<li><a href="#1243-windowprotocolonconnectionstatechangedevent%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">1.2.4.3. WindowProtocol.OnConnectionStateChangedEventプロパティにコールバックメソッドを追加する</a></li>
</ul>
</li>
<li><a href="#125-scope%E3%81%AE%E9%9D%99%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%9C%AC%E4%BD%93%E5%9E%8B%E7%95%AA%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E3%83%8A%E3%83%B3%E3%83%90%E3%83%BCfw%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3pnpid">1.2.5. Scopeの静的情報の取得(本体型番、シリアルナンバー、FWバージョン、PnPID)</a></li>
<li><a href="#126-scope%E3%81%B8%E3%81%AE%E6%8C%AF%E5%8B%95%E6%8C%87%E7%A4%BA%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E6%8A%BC%E3%81%97%E3%81%9F%E9%9A%9B%E3%81%ABscope%E3%82%92%E6%8C%AF%E5%8B%95%E3%81%95%E3%81%9B%E3%82%8B">1.2.6. Scopeへの振動指示：ボタンを押した際にScopeを振動させる</a></li>
<li><a href="#127-unity%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%B5%82%E4%BA%86%E3%82%92%E6%9C%AC%E4%BD%93%E3%81%AB%E4%BC%9D%E3%81%88%E3%82%8B%E3%82%B2%E3%83%BC%E3%83%A0%E7%B5%82%E4%BA%86%E6%99%82%E3%81%AByo%E6%9C%AC%E4%BD%93%E6%A9%9F%E8%83%BD%E3%81%AB%E6%88%BB%E3%82%8B">1.2.7. Unityアプリの終了を本体に伝える：ゲーム終了時にYo本体機能に戻る</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="1-サンプルデモ-roll-a-ball-game-for-atmoph-window">1. サンプルデモ Roll-a-Ball Game for Atmoph Window</h1>
<p>Unityの一般的なサンプルデモ <a href="https://learn.unity.com/project/roll-a-ball">Roll-a-Ball Game</a> をSDKを用いてYoで遊べるようにしたデモです。サンプルデモプロジェクトのScenes/MiniGameに実装されています。</p>
<div class="NOTE">
<h5>Note</h5>
<p>Roll-a-Ball Gameの内容や実装方法については、Unityの公式ドキュメント<a href="https://learn.unity.com/project/roll-a-ball">Roll-a-Ball Game</a> を参照してください。</p>
</div>
<p><img src="images/sample_demo_1_scene.png" alt="Button Mapping"></p>
<h2 id="11-動かし方">1.1. 動かし方</h2>
<h3 id="111-unityhubでuniversal-3d-の空プロジェクトを作成する">1.1.1. UnityHubでUniversal 3D の空プロジェクトを作成する。</h3>
<p><img src="images/sample_demo_1_start_1.png" alt="Start Sample Demo1 1"></p>
<h3 id="112-プロジェクトにサンプルデモパッケージrollaballforatmophwindow_v1_0unitypackageをインポートする">1.1.2. プロジェクトにサンプルデモパッケージ&quot;rollaballforatmophwindow_v1_0.unitypackage&quot;をインポートする。</h3>
<p><img src="images/sample_demo_1_start_2.png" alt="Start Sample Demo1 2"></p>
<p><img src="images/sample_demo_1_start_3.png" alt="Start Sample Demo1 3"></p>
<h3 id="113-ビルド設定を実施する">1.1.3. <a href="installation.html#%E3%83%93%E3%83%AB%E3%83%89%E8%A8%AD%E5%AE%9A">ビルド設定</a>を実施する。</h3>
<div class="NOTE">
<h5>Note</h5>
<p>デモにはすでに<a href="installation.html#%E3%83%93%E3%83%AB%E3%83%89%E8%A8%AD%E5%AE%9A">ビルド設定</a>の設定を実施した&quot;New Android Profile&quot;も存在しています。こちらを利用してもらっても構いません。</p>
<p><img src="images/sample_demo_1_start_4.png" alt="Start Sample Demo1 4"></p>
</div>
<div class="NOTE">
<h5>Note</h5>
<p>&quot;Build Profile&quot;の&quot;Configuration&quot; -&gt; &quot;Active Input Handling&quot;は&quot;Both&quot;を設定してください。</p>
</div>
<div class="NOTE">
<h5>Note</h5>
<p>デモは <a href="installation.html#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%89%8B%E9%A0%86">SDKのインストール</a> はすでに実施済みの状態になっています。</p>
</div>
<h3 id="114-projectのassets---scenes-の-minigameを開く">1.1.4. Projectの&quot;Assets&quot; -&gt; &quot;Scenes&quot; の &quot;MiniGame&quot;を開く</h3>
<p><img src="images/sample_demo_1_start_5.png" alt="Start Sample Demo1 5"></p>
<h3 id="115-build-profilesの-scene-list-が-minigame-のみになるように設定">1.1.5. &quot;Build Profiles&quot;の &quot;Scene List&quot; が &quot;MiniGame&quot; のみになるように設定</h3>
<p>メニューの&quot;File&quot; -&gt; &quot;Build Profiles&quot;を開き、その&quot;Scene List&quot;項目を開きます。
デフォルトで設定されている &quot;Scenes/SampleScene&quot;を削除します。</p>
<p><img src="images/sample_demo_1_start_6.png" alt="Start Sample Demo1 6"></p>
<p><img src="images/sample_demo_1_start_7.png" alt="Start Sample Demo1 7"></p>
<p>&quot;Add Open Scenes&quot; ボタンで &quot;MiniGame&quot; を設定します。</p>
<p><img src="images/sample_demo_1_start_8.png" alt="Start Sample Demo1 8"></p>
<h3 id="116-build-and-run-を実行">1.1.6. &quot;Build And Run&quot; を実行</h3>
<p>メニューの&quot;File&quot; -&gt; &quot;Build And Run&quot;を実行します。</p>
<div class="CAUTION">
<h5>Caution</h5>
<p>実行時の次のような警告ダイアログが出る場合がありますが、Yesを選択して無視してください。</p>
<p><img src="images/sample_demo_1_dialog_1.png" alt="Sample Demo1 Dialog1">
<img src="images/sample_demo_1_dialog_2.png" alt="Sample Demo1 Dialog2"></p>
</div>
<div class="CAUTION">
<h5>Caution</h5>
<p>デモの影のジャギーが気になる場合は、&quot;Project Settings&quot; -&gt; &quot;Quality&quot; の &quot;Levels&quot; 項目で、Androidアイコンの設定をデフォルトの &quot;Mobile&quot; から &quot;PC&quot; に切り替えてください。Mobile用品質からPC用品質に変わることで、影の画質が向上してジャギーが軽減します。</p>
<p><img src="images/sample_demo_1_start_9.png" alt="Sample Demo1 Jaggy"></p>
<p><img src="images/sample_demo_1_start_10.png" alt="Sample Demo1 Jaggy2"></p>
<p><img src="images/sample_demo_1_start_11.png" alt="Sample Demo1 Jaggy3"></p>
</div>
<h2 id="12-使用しているsdkの機能">1.2. 使用しているSDKの機能</h2>
<p>このデモではSDKの次の機能を使用しています。</p>
<ol>
<li><a href="how_to_use.html#11-scope%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E6%93%8D%E4%BD%9C%E3%81%AE%E6%A4%9C%E7%9F%A5">Scopeのボタン操作の検知</a> : プレイヤーをScopeのボタンでコントロールできるようにする</li>
<li><a href="how_to_use.html#13-scope%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%8D%E7%BD%AE%E5%90%91%E3%81%8D%E8%B7%9D%E9%9B%A2%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97">Scopeのポインティング位置、向き、距離センター値の取得</a> : 地面の角度をScopeの向きでコントロールできるようにする</li>
<li><a href="how_to_use.html#12-scope%E3%81%AE%E3%82%BA%E3%83%BC%E3%83%A0%E3%83%AA%E3%83%B3%E3%82%B0%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%8F%96%E5%BE%97">Scopeのズームリングデータの取得</a>：ズームリング、クォータニオン形式のScopeの向き、ボタン状態の画面出力</li>
<li><a href="how_to_use.html#14-scope%E3%81%AE%E5%8B%95%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%8E%A5%E7%B6%9A%E7%8A%B6%E6%85%8B%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E6%AE%8B%E9%87%8F">Scopeの動的情報の取得（接続状態、アドレス、バッテリー残量）</a>：接続状態の画面表示や、バッテリー残量のログ出力</li>
<li><a href="how_to_use.html#15-scope%E3%81%AE%E9%9D%99%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%9C%AC%E4%BD%93%E5%9E%8B%E7%95%AA%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E3%83%8A%E3%83%B3%E3%83%90%E3%83%BCfw%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3pnpid">Scopeの静的情報の取得(本体型番、シリアルナンバー、FWバージョン、PnPID)</a>：Scope情報のログ出力</li>
<li><a href="how_to_use.html#16-scope%E3%81%B8%E3%81%AE%E6%8C%AF%E5%8B%95%E6%8C%87%E7%A4%BA">Scopeへの振動指示</a>：ボタンを押した際にScopeを振動させる</li>
<li><a href="how_to_use.html#17-unity%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%B5%82%E4%BA%86%E3%82%92%E6%9C%AC%E4%BD%93%E3%81%AB%E4%BC%9D%E3%81%88%E3%82%8B">Unityアプリの終了を本体に伝える</a>：ゲーム終了時にYo本体機能に戻る</li>
</ol>
<h3 id="121-scopeのボタン操作の検知--プレイヤーをscopeのボタンでコントロールできるようにする">1.2.1. <a href="how_to_use.html#1-1-scope%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E6%93%8D%E4%BD%9C%E3%81%AE%E6%A4%9C%E7%9F%A5">Scopeのボタン操作の検知</a> : プレイヤーをScopeのボタンでコントロールできるようにする</h3>
<p>WindowProtocol.prefabをHierarchyウィンドウに追加し、その子オブジェクトのVirtualButtonsの子オブジェクトでScopeの各ボタンをInputControlにマッピングしています。マッピング先は次のようになっています。</p>
<table>
<thead>
<tr>
<th>オブジェクト</th>
<th>InputControl</th>
</tr>
</thead>
<tbody>
<tr>
<td>Power</td>
<td>P [Keyboard]</td>
</tr>
<tr>
<td>Up</td>
<td>Stick/Up [Joystick]</td>
</tr>
<tr>
<td>Down</td>
<td>Stick/Down [Joystick]</td>
</tr>
<tr>
<td>Left</td>
<td>Stick/Left [Joystick]</td>
</tr>
<tr>
<td>Right</td>
<td>Stick/Right [Joystick]</td>
</tr>
<tr>
<td>Main</td>
<td>Space [Keyboard]</td>
</tr>
<tr>
<td>Menu</td>
<td>M [Keyboard]</td>
</tr>
<tr>
<td>View</td>
<td>V [Keyboard]</td>
</tr>
<tr>
<td>Trigget</td>
<td>Q [Keyboard]</td>
</tr>
</tbody>
</table>
<p><img src="images/sample_demo_1_buttons.png" alt="Button Mapping"></p>
<h3 id="122-scopeのポインティング位置向き距離センター値の取得--地面の角度をscopeの向きでコントロールできるようにする">1.2.2. <a href="how_to_use.html#13-scope%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%8D%E7%BD%AE%E5%90%91%E3%81%8D%E8%B7%9D%E9%9B%A2%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97">Scopeのポインティング位置、向き、距離センター値の取得</a> : 地面の角度をScopeの向きでコントロールできるようにする</h3>
<p>Scripts/SurroundingController.csで使用しています。</p>
<pre><code class="lang-csharp">    void FixedUpdate()
    {
        // Slightly rotate the floor with Scope's gyroscope
        var offset = WindowProtocol.Instance.ScopeOffset.FirstOrDefault().Value;
        var data = WindowProtocol.Instance.ScopeConvertedData.FirstOrDefault().Value;
        if (data != null &amp;&amp; offset != null)
        {
            var pitch = Mathf.Rad2Deg * (data.pitch - offset.pitch);
            var roll = Mathf.Rad2Deg * (data.roll - offset.roll);
            var yaw = Mathf.Rad2Deg * (data.yaw - offset.yaw);
            var origin = new Vector3(pitch, roll, yaw);
            var z = -Mathf.Clamp(pitch * AngleFactorPitch, -AngleLimit, AngleLimit);
            var y = 0f; // -Mathf.Clamp(yaw * AngleFactor, -AngleLimit, AngleLimit); // fixed
            var x = -Mathf.Clamp(roll * AngleFactorRoll, -AngleLimit, AngleLimit);
            var rotation = new Vector3(z, y, x);
            rb.MoveRotation(Quaternion.Euler(rotation));
            // Debug.Log($&quot;gameObject.transform.eulerAngle: {origin} -&gt; {rotation}&quot;);
        }
    }
</code></pre>
<p><a href="how_to_use.html#13-scope%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E4%BD%8D%E7%BD%AE%E5%90%91%E3%81%8D%E8%B7%9D%E9%9B%A2%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E5%80%A4%E3%81%AE%E5%8F%96%E5%BE%97">WindowProtocol.ScopeConvertedData</a>プロパティから取得したその時点のScopeの<a class="xref" href="api/Atmoph.ConvertedData.html">ConvertedData</a>からScopeの角度(<a class="xref" href="api/Atmoph.ConvertedData.html#Atmoph_ConvertedData_pitch">ConvertedData.pitch</a>、<a class="xref" href="api/Atmoph.ConvertedData.html#Atmoph_ConvertedData_yaw">ConvertedData.yaw</a>、<a class="xref" href="api/Atmoph.ConvertedData.html#Atmoph_ConvertedData_roll">ConvertedData.roll</a>)を取得し、それを基に地面を回転しています。</p>
<pre><code>var data = WindowProtocol.Instance.ScopeConvertedData.FirstOrDefault().Value;
</code></pre>
<p>Scopeの「ポインティング位置のリセット」機能にも対応できるように、<a href="how_to_use.html#31-offset">Offset</a>機能の<a href="xref:WindowProtocol.ScopeOffset">オフセット値</a>も取得し、<a class="xref" href="api/Atmoph.ConvertedData.html">ConvertedData</a>とオフセットとの差分から角度を算出しています。</p>
<p>オフセット値の取得方法は<a href="how_to_use.html#311-windowprotocolscopeoffsetwindowprotocolscoperawoffset-%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%8B%E3%82%89%E3%81%AEoffset%E3%81%AE%E5%8F%96%E5%BE%97">WindowProtocol.ScopeOffset、WindowProtocol.ScopeRawOffset プロパティからのOffsetの取得</a>を使用しています。</p>
<pre><code>var offset = WindowProtocol.Instance.ScopeOffset.FirstOrDefault().Value;
</code></pre>
<h3 id="123-scopeのズームリングデータの取得ズームリングクォータニオン形式のscopeの向きボタン状態の画面出力">1.2.3. <a href="how_to_use.html#12-scope%E3%81%AE%E3%82%BA%E3%83%BC%E3%83%A0%E3%83%AA%E3%83%B3%E3%82%B0%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%8F%96%E5%BE%97">Scopeのズームリングデータの取得</a>：ズームリング、クォータニオン形式のScopeの向き、ボタン状態の画面出力</h3>
<p>ScopeRawDataPrinter.csのUpdateメソッドで、接続しているScopeのズームリング、クォータニオン形式のScopeの向き、ボタン状態の情報を持った<a class="xref" href="api/Atmoph.RawData.html">RawData</a>を画面に出力しています。</p>
<pre><code class="lang-csharp">    void Update()
    {
        var data = Atmoph.ScopeRawData.FirstOrDefault().Value;
        textMeshProUGUI.text = (data != null) ? data.ToString() : &quot;&quot;;
    }
</code></pre>
<h3 id="124-scopeの動的情報の取得接続状態アドレスバッテリー残量接続状態の画面表示やバッテリー残量のログ出力">1.2.4. <a href="how_to_use.html#14-scope%E3%81%AE%E5%8B%95%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%8E%A5%E7%B6%9A%E7%8A%B6%E6%85%8B%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E6%AE%8B%E9%87%8F">Scopeの動的情報の取得（接続状態、アドレス、バッテリー残量）</a>：接続状態の画面表示や、バッテリー残量のログ出力</h3>
<p>GameManager.csのUpdateメソッドで「Powerボタンを押すとバッテリー残量をログに出力」の機能が実装されています。</p>
<p>バッテリー残量のログ出力は次のコードで実装されています。<a href="how_to_use.html#1412-windowprotocolscopeconnectionstate%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E7%94%A8">WindowProtocol.ScopeConnectionState</a>で取得した接続中Scopeのアドレスを用いて、WindowProtocol.GetBatteryLevel(how_to_use.html#1-4-2-バッテリー残量の取得)メソッドでバッテリー残量を取得しています。</p>
<pre><code class="lang-csharp">        else if (current?.pKey?.wasReleasedThisFrame == true)
        {
            var address = Atmoph.ScopeConnectionState.FirstOrDefault().Key;
            if (address != null)
            {
                Atmoph.Vibrate(new string[]{address}, 123);
                Debug.Log($&quot;battery: {WindowProtocol.GetBatteryLevel(address)}&quot;);
            }
        }
</code></pre>
<p>接続状態は次の３つの方法で取得されています。</p>
<h4 id="1241-windowprotocolscopeconnectionstateプロパティを使用">1.2.4.1. <a href="how_to_use.html#1412-windowprotocolscopeconnectionstate%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E7%94%A8">WindowProtocol.ScopeConnectionStateプロパティを使用</a></h4>
<p>上記のWindowProtocol.GetBatteryLevelメソッドの引数に設定するScopeアドレスを取得する方法です。</p>
<h4 id="1242-windowprotocolgetscopesメソッドを使用">1.2.4.2. <a href="how_to_use.html#1411-windowprotocolgetscopes%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8">WindowProtocol.GetScopesメソッドを使用</a></h4>
<p>GameManager.csのUpdateメソッドの次の処理で使われています。<a class="xref" href="api/Atmoph.BondedScope.html">BondedScope</a>インスタンスで接続状態を一括で取得しています。</p>
<pre><code>Debug.Log($&quot;GetScopes: {Atmoph.GetScopes()}&quot;);
</code></pre>
<h4 id="1243-windowprotocolonconnectionstatechangedeventプロパティにコールバックメソッドを追加する">1.2.4.3. <a href="how_to_use.html#1413-windowprotocolonconnectionstatechangedevent%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">WindowProtocol.OnConnectionStateChangedEventプロパティにコールバックメソッドを追加する</a></h4>
<p>GameManager.csのSetListenersメソッドで次のように<a class="xref" href="api/Atmoph.WindowProtocol.html#Atmoph_WindowProtocol_OnConnectionStateChangedEvent">WindowProtocol.OnConnectionStateChangedEvent</a>へのコールバックメソッドの追加、削除が実装されています。Scopeの新規接続、接続解除のタイミングで呼び出されるコールバックメソッドで処理しています。</p>
<pre><code class="lang-csharp">    private void SetListeners(bool state)
    {
        if (state)
        {
            Atmoph.OnConnectionStateChangedEvent.AddListener(OnScopeStateChanged);
            player.GetComponent&lt;PlayerController&gt;().onTouchedEvent.AddListener(OnPlayerTouched);
        }
        else
        {
            Atmoph.OnConnectionStateChangedEvent.RemoveAllListeners();
            player.GetComponent&lt;PlayerController&gt;().onTouchedEvent.RemoveAllListeners();
        }
    }

    // Check Connection state changed &amp; Show on screen.
    private void OnScopeStateChanged()
    {
        var state = Atmoph.ScopeConnectionState.FirstOrDefault();
        Debug.Log($&quot;OnScopeStateChanged. {state.Key}: {state.Value}&quot;);
        stateText.text = state.Value ? &quot;Connected&quot; : &quot;Disconnected&quot;;
    }
</code></pre>
<h3 id="125-scopeの静的情報の取得本体型番シリアルナンバーfwバージョンpnpid">1.2.5. <a href="how_to_use.html#15-scope%E3%81%AE%E9%9D%99%E7%9A%84%E6%83%85%E5%A0%B1%E3%81%AE%E5%8F%96%E5%BE%97%E6%9C%AC%E4%BD%93%E5%9E%8B%E7%95%AA%E3%82%B7%E3%83%AA%E3%82%A2%E3%83%AB%E3%83%8A%E3%83%B3%E3%83%90%E3%83%BCfw%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3pnpid">Scopeの静的情報の取得(本体型番、シリアルナンバー、FWバージョン、PnPID)</a></h3>
<p>GameManager.csのUpdateメソッドの次の処理で使われています。<a href="how_to_use.html#1-4-1-2-windowprotocolscopeconnectionstate%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%82%92%E4%BD%BF%E7%94%A8">Atmoph.ScopeConnectionState</a>で取得した接続中Scopeのアドレスを用いて、WindowProtocol.GetScopeInfo(how_to_use.html#1-5-scopeの静的情報の取得本体型番シリアルナンバーfwバージョンpnpid)メソッドでScopeの静的情報を取得、ログに出力しています。</p>
<pre><code class="lang-csharp">        else if (current?.mKey?.wasPressedThisFrame == true)
        {
            Debug.Log($&quot;GetScopes: {Atmoph.GetScopes()}&quot;);
            var address = Atmoph.ScopeConnectionState.FirstOrDefault().Key;
            if (address != null)
                Debug.Log($&quot;GetScopeInfo: {Atmoph.GetScopeInfo(address)}&quot;);
        }
</code></pre>
<h3 id="126-scopeへの振動指示ボタンを押した際にscopeを振動させる">1.2.6. <a href="how_to_use.html#16-scope%E3%81%B8%E3%81%AE%E6%8C%AF%E5%8B%95%E6%8C%87%E7%A4%BA">Scopeへの振動指示</a>：ボタンを押した際にScopeを振動させる</h3>
<p>GameManager.csのUpdateメソッドで「Power、風景ボタンを押すとScopeが振動」の機能が実装されています。
Powerボタンが押された際は
<a class="xref" href="api/Atmoph.WindowProtocol.html#Atmoph_WindowProtocol_Vibrate_System_String___System_Int32_">WindowProtocol.Vibrate</a>、風景ボタンが押された際は
<a class="xref" href="api/Atmoph.WindowProtocol.html#Atmoph_WindowProtocol_VibrateToAll_System_Int32_">WindowProtocol.VibrateToAll</a>でScopeに振動を指示しています。</p>
<pre><code class="lang-csharp">        else if (current?.pKey?.wasReleasedThisFrame == true)
        {
            var address = Atmoph.ScopeConnectionState.FirstOrDefault().Key;
            if (address != null)
            {
                Atmoph.Vibrate(new string[]{address}, 123);
                Debug.Log($&quot;battery: {Atmoph.GetBatteryLevel(address)}&quot;);
            }
        }
        else if (current?.vKey?.wasReleasedThisFrame == true)
            Atmoph.VibrateToAll(123);
</code></pre>
<h3 id="127-unityアプリの終了を本体に伝えるゲーム終了時にyo本体機能に戻る">1.2.7. <a href="how_to_use.html#17-unity%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%B5%82%E4%BA%86%E3%82%92%E6%9C%AC%E4%BD%93%E3%81%AB%E4%BC%9D%E3%81%88%E3%82%8B">Unityアプリの終了を本体に伝える</a>：ゲーム終了時にYo本体機能に戻る</h3>
<p>GameManager.csのUpdateメソッドで「トリガーボタンを押すとゲーム終了」の機能が実装されています。<a class="xref" href="api/Atmoph.WindowProtocol.html#Atmoph_WindowProtocol_GoBackToWindow">WindowProtocol.GoBackToWindow</a>メソッドでゲームの終了をYo本体に伝えた上で、ゲームの終了処理を実施しています。</p>
<pre><code class="lang-csharp">        else if (current?.qKey?.wasReleasedThisFrame == true)
        {
            Atmoph.GoBackToWindow();
            QuitGame();
        }
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>ゲームの終了処理はゲーム自身で行う必要があります。</p>
</div>

</article>

        <div class="contribution d-print-none">
          <a href="https://bitbucket.org/atmophinc/limosaunitysdk/src/main/Docfx/sample_demo_1.md#lines-1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
